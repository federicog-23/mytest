<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allenamento üèãÔ∏è‚Äç‚ôÇÔ∏è</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --bg: #f0f4f8;
  --card: #ffffff;
  --accent: #2ecc71;
  --accent-dark: #27ae60;
  --muted: #6b7280;
  --danger: #e74c3c;
  --weight-color: #3498db;
  --reps-color: #e67e22;
  --time-color: #9b59b6;
  --edit-color: #e67e22;
  font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, Arial;
}

body { margin: 0; background: var(--bg); color: #111; }

header {
  text-align: center;
  padding: 20px;
  color: white;
  position: relative;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  background: linear-gradient(135deg, #6a11cb, #2575fc);
  background-size: 400% 400%;
  animation: gradientAnimation 15s ease infinite;
  display: flex;
  align-items: center;
  justify-content: center;
}
header h1 { position: relative; z-index: 1; margin: 0; font-size: 1.8rem; }
@keyframes gradientAnimation { 0% {background-position: 0% 50%;} 50% {background-position: 100% 50%;} 100% {background-position: 0% 50%;} }

#colorBtn, #timerBtn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 30px;
  height: 30px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  z-index: 2;
}
#colorBtn { left: 10px; }
#timerBtn { right: 10px; }
#colorBtn i, #timerBtn i { color: white; }

.container { max-width: 800px; margin: auto; padding: 10px; }
.controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin-bottom: 15px; }
.controls select, .controls button { padding: 10px; border-radius: 8px; border: 1px solid #ccc; flex: 1; cursor: pointer; }
.btn { transition: all 0.2s; border: none; border-radius: 8px; padding: 8px 12px; }
.btn.primary { background: var(--accent); color: white; }
.btn.primary:hover { background: var(--accent-dark); }
.btn.danger { background: var(--danger); color: white; }
.btn.edit { background: var(--edit-color); color: white; }
.btn:hover { opacity: 0.9; }

.card { 
  background: var(--card); 
  padding: 15px; 
  border-radius: 12px; 
  box-shadow: 0 4px 12px rgba(0,0,0,0.05); 
  margin-bottom: 12px; 
  transition: transform 0.2s; 
  position: relative; 
}
.card:hover { transform: translateY(-2px); }

/* pulsanti nelle sezioni: assoluti */
.card.section .controls {
  position: absolute;
  bottom: 10px;
  right: 10px;
  display: flex;
  gap: 5px;
}

/* pulsanti negli esercizi: in fondo alla card */
.exercise .controls {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: auto; /* spinge i pulsanti in fondo */
  padding-top: 10px;
  border-top: 1px solid #eee;
}

/* media query mobile */
@media (max-width: 600px) {
  .exercise .controls,
  .card.section .controls {
    position: static !important;
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: wrap !important;
    justify-content: flex-start !important;
    margin-top: 8px;
    gap: 5px; /* ridotto per mobile */
  }

  .exercise .controls button,
  .card.section .controls button {
    flex: 0 1 auto; /* non si espandono troppo */
    min-width: 0;   /* rimuove il vincolo */
  }

    /* riduce le icone solo nelle sezioni */
  .card.section .controls button i {
    font-size: 0.75rem; /* icone pi√π piccole */
  }
}



.weight-history, .reps-history, .time-display, .note-container { 
  font-size: 0.85rem; 
  margin-top: 3px; 
  font-weight: 500; 
}
.weight-history { color: var(--weight-color); }
.reps-history { color: var(--reps-color); }
.time-display { color: var(--time-color); }
.note-container { background: #f9f9f9; padding: 5px 8px; border-radius: 6px; border: 1px solid #ccc; white-space: pre-wrap; word-break: break-word; min-height: 20px; margin-top:5px; }

.modal { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); z-index: 1000; }
.modal.hidden { display: none; }
.modal-content { width: 90%; max-width: 400px; padding: 20px; background: var(--card); border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
.modal-content input, .modal-content textarea, .modal-content select { width: 100%; padding: 10px; margin-top: 8px; border-radius: 8px; border: 1px solid #ccc; }
.modal-content textarea { resize: vertical; min-height: 60px; }
.modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }

.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent);
  color: white;
  padding: 12px 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.4s;
}
.toast.show { opacity: 1; pointer-events: auto; }

@media (max-width: 600px) {
  .controls { flex-direction: column; } 
  .exercise input { width: 60px; margin-bottom: 5px; } 
  .exercise .controls,
  .card.section .controls {
    position: static !important;
    flex-wrap: wrap !important;
    justify-content: flex-start !important;
    margin-top: 8px;
  }
  .exercise .controls button,
  .card.section .controls button { flex: 1 1 auto; min-width: 50px; }
}


</style>
</head>
<body>
<header>
  <div id="colorBtn"><i class="fa fa-pencil"></i></div>
  <h1>Allenamento üèãÔ∏è‚Äç‚ôÇÔ∏è</h1>
  <div id="timerBtn"><i class="fa fa-clock"></i></div>
</header>

<div id="updateBox" style="background:#fff3cd;border:1px solid #ffeeba;padding:10px;border-radius:8px;margin-bottom:10px;font-size:0.9rem;color:#856404;">
üîî Aggiornamento:<br>
- Cliccando in alto a sinistra sulla matita, puoi modificare il colore della barra superiore.<br>
- Cliccando in alto a destra sul timer, puoi impostare il timer durante l'allenamento.<br>
- 'Crea sezione' utile a distinguere i gruppi muscolari.<br>
- 'Note', utile a segnare appunti sul tuo esercizio.<br>
- Se modifichi il peso e salvi, risulter√† il progressivo.<br><br>
Mi dispiace se i tuoi dati sono andati persi.<br>
Nun ci scassare a minchia e allenati ‚ù§Ô∏è
</div>

<div class="container">
  <div class="controls">
    <select id="daySelect">
      <option>Luned√¨</option>
      <option>Marted√¨</option>
      <option>Mercoled√¨</option>
      <option>Gioved√¨</option>
      <option>Venerd√¨</option>
      <option>Sabato</option>
      <option>Domenica</option>
    </select>
    <button class="btn primary" id="addExerciseBtn"><i class="fa fa-plus"></i> Aggiungi esercizio</button>
    <button class="btn primary" id="addSectionBtn"><i class="fa fa-folder-plus"></i> Crea sezione</button>
  </div>

  <h2 id="dayTitle">Luned√¨</h2>
  <div id="exerciseContainer"></div>
</div>

<!-- Modal Esercizio -->
<div id="modal" class="modal hidden">
 <div class="modal-content">
  <h3 id="modalTitle">Aggiungi esercizio</h3>
  <label>Nome esercizio</label><input id="newExerciseName" type="text">
  <label>Peso</label><input id="newExerciseWeight" type="text">
  <label>Ripetizioni</label><input id="newExerciseReps" type="text">
  <label>Recupero/Tempo</label><input id="newExerciseCardio" type="text">
  <label>Note</label><textarea id="newExerciseNotes"></textarea>
  <div class="modal-actions">
    <button class="btn primary" id="saveExerciseBtn">Salva</button>
    <button class="btn danger" id="closeModalBtn">Chiudi</button>
  </div>
 </div>
</div>

<!-- Modal Colore -->
<div id="colorModal" class="modal hidden">
  <div class="modal-content">
    <h3>Scegli colore header</h3>
    <select id="colorSelect">
      <option value="#6a11cb">Viola</option>
      <option value="#2575fc">Blu</option>
      <option value="#2ecc71">Verde</option>
      <option value="#e74c3c">Rosso</option>
      <option value="#f39c12">Arancione</option>
      <option value="#34495e">Grigio scuro</option>
      <option value="#000000">Nero</option>
    </select>
    <div class="modal-actions">
      <button class="btn primary" id="applyColorBtn">Applica</button>
      <button class="btn danger" id="closeColorModal">Chiudi</button>
    </div>
  </div>
</div>

<!-- Modal Timer -->
<div id="timerModal" class="modal hidden">
  <div class="modal-content">
    <h3>Timer</h3>
    <input type="number" id="timerMinutes" placeholder="Minuti" min="0">
    <input type="number" id="timerSeconds" placeholder="Secondi" min="0">
    <div style="margin-top:10px; display:flex; gap:5px; flex-wrap: wrap;">
      <button class="btn primary quickTimerBtn" data-ms="30000">30 sec</button>
      <button class="btn primary quickTimerBtn" data-ms="60000">1 min</button>
      <button class="btn primary quickTimerBtn" data-ms="90000">1:30</button>
      <button class="btn primary quickTimerBtn" data-ms="120000">2 min</button>
    </div>
    <div class="modal-actions" style="margin-top:10px;">
      <button class="btn primary" id="startTimerBtn">Avvia</button>
      <button class="btn danger" id="stopTimerBtn">Ferma</button>
      <button class="btn edit" id="resetTimerBtn">Reset</button>
      <button class="btn danger" id="closeTimerModal">Chiudi</button>
    </div>
    <div style="margin-top:10px; font-size:1.2rem;" id="timerDisplay">00:00.00</div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
// --- COLORI ---
const header = document.querySelector("header");
const colorBtn = document.getElementById("colorBtn");
const colorModal = document.getElementById("colorModal");
const colorSelect = document.getElementById("colorSelect");
const applyColorBtn = document.getElementById("applyColorBtn");
const closeColorModal = document.getElementById("closeColorModal");
const savedColor = localStorage.getItem("headerColor");
if(savedColor){ header.style.background = savedColor; colorBtn.style.background = savedColor; }

colorBtn.addEventListener("click", ()=>colorModal.classList.remove("hidden"));
closeColorModal.addEventListener("click", ()=>colorModal.classList.add("hidden"));
applyColorBtn.addEventListener("click", ()=>{
  const val = colorSelect.value;
  header.style.background = val; colorBtn.style.background = val;
  localStorage.setItem("headerColor", val);
  colorModal.classList.add("hidden");
});

// --- TIMER ---
const timerBtn = document.getElementById("timerBtn");
const timerModal = document.getElementById("timerModal");
const closeTimerModal = document.getElementById("closeTimerModal");
const timerMinutes = document.getElementById("timerMinutes");
const timerSeconds = document.getElementById("timerSeconds");
const startTimerBtn = document.getElementById("startTimerBtn");
const stopTimerBtn = document.getElementById("stopTimerBtn");
const resetTimerBtn = document.getElementById("resetTimerBtn");
const timerDisplay = document.getElementById("timerDisplay");
const quickTimerBtns = document.querySelectorAll(".quickTimerBtn");
let timerInterval=null,totalMilliseconds=0;

timerBtn.addEventListener("click", ()=>timerModal.classList.remove("hidden"));
closeTimerModal.addEventListener("click", ()=>{
  timerModal.classList.add("hidden");
  clearInterval(timerInterval); totalMilliseconds=0; updateTimerDisplay();
});
function updateTimerDisplay(){
  const m=Math.floor(totalMilliseconds/60000);
  const s=Math.floor((totalMilliseconds%60000)/1000);
  const cs=Math.floor((totalMilliseconds%1000)/10);
  timerDisplay.textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}.${String(cs).padStart(2,'0')}`;
}
startTimerBtn.addEventListener("click", ()=>{
  const m=parseInt(timerMinutes.value)||0,s=parseInt(timerSeconds.value)||0;
  totalMilliseconds=m*60000+s*1000; startInterval();
});
stopTimerBtn.addEventListener("click", ()=>clearInterval(timerInterval));
resetTimerBtn.addEventListener("click", ()=>{ clearInterval(timerInterval); totalMilliseconds=0; updateTimerDisplay(); showToast("Timer resettato!"); });
quickTimerBtns.forEach(b=>b.addEventListener("click",()=>{ totalMilliseconds=parseInt(b.dataset.ms); startInterval(); }));
function startInterval(){
  clearInterval(timerInterval);
  updateTimerDisplay();
  timerInterval=setInterval(()=>{
    if(totalMilliseconds<=0){ clearInterval(timerInterval); showToast("Timer terminato!"); return; }
    totalMilliseconds-=10; updateTimerDisplay();
  },10);
}

// --- TOAST ---
const toast=document.getElementById("toast");
function showToast(msg){ toast.textContent=msg; toast.classList.add("show"); setTimeout(()=>toast.classList.remove("show"),2000); }

// --- DATI E ESECUZIONE ---
const STORAGE_KEY="gym_notes_premium";
const daySelect=document.getElementById("daySelect");
const dayTitle=document.getElementById("dayTitle");
const exerciseContainer=document.getElementById("exerciseContainer");
const addExerciseBtn=document.getElementById("addExerciseBtn");
const addSectionBtn=document.getElementById("addSectionBtn");
const modal=document.getElementById("modal");
const saveExerciseBtn=document.getElementById("saveExerciseBtn");
const closeModalBtn=document.getElementById("closeModalBtn");
const newExerciseName=document.getElementById("newExerciseName");
const newExerciseWeight=document.getElementById("newExerciseWeight");
const newExerciseReps=document.getElementById("newExerciseReps");
const newExerciseCardio=document.getElementById("newExerciseCardio");
const newExerciseNotes=document.getElementById("newExerciseNotes");
const modalTitle=document.getElementById("modalTitle");
let editIndex=null;

function loadData(){ return JSON.parse(localStorage.getItem(STORAGE_KEY)||"{}"); }
function saveData(d){ localStorage.setItem(STORAGE_KEY, JSON.stringify(d)); }

function renderExercises(){
  const data=loadData(); const day=daySelect.value;
  dayTitle.textContent=day;
  const exercises=data[day]||[];
  exerciseContainer.innerHTML="";
  exercises.forEach((ex,index)=>{
    const div=document.createElement("div");
    if(ex.isSection){
      div.classList.add("card","section");
      div.style.background="#d1ecf1"; div.style.borderLeft="5px solid #17a2b8";
      div.innerHTML=`<strong style="font-size:1.1rem;">üìå ${ex.sectionName}</strong><div class="controls">
        <button class="btn" onclick="editSection('${day}',${index})"><i class="fa fa-pencil"></i></button>
        <button class="btn danger" onclick="deleteExercise('${day}',${index})"><i class="fa fa-trash"></i></button>
        <button class="btn" onclick="moveUp('${day}',${index})"><i class="fa fa-arrow-up"></i></button>
        <button class="btn" onclick="moveDown('${day}',${index})"><i class="fa fa-arrow-down"></i></button>
      </div>`; exerciseContainer.appendChild(div); return; }

    div.classList.add("card","exercise");
    let infoHTML=`<strong>${ex.name}</strong>`;
    if(ex.weightHistory?.length) infoHTML+=`<div class="weight-history"><i class="fa fa-dumbbell"></i> ${ex.weightHistory.join(" ‚Üí ")}</div>`;
    if(ex.reps) infoHTML+=`<div class="reps-history"><i class="fa fa-repeat"></i> ${ex.reps}</div>`;
    if(ex.cardio) infoHTML+=`<div class="time-display"><i class="fa fa-clock"></i> ${ex.cardio}</div>`;
    if(ex.notes) infoHTML+=`<div class="note-container"><i class="fa fa-sticky-note"></i> ${ex.notes}</div>`;
    div.innerHTML=`<div class="info">${infoHTML}</div><div class="controls">
      <button class="btn edit" onclick="editExercise('${day}',${index})"><i class="fa fa-pencil"></i></button>
      <button class="btn danger" onclick="deleteExercise('${day}',${index})"><i class="fa fa-trash"></i></button>
      <button class="btn" onclick="moveUp('${day}',${index})"><i class="fa fa-arrow-up"></i></button>
      <button class="btn" onclick="moveDown('${day}',${index})"><i class="fa fa-arrow-down"></i></button>
    </div>`; exerciseContainer.appendChild(div);
  });
}

addExerciseBtn.addEventListener("click",()=>{
  modalTitle.textContent="Aggiungi esercizio";
  newExerciseName.value=newExerciseWeight.value=newExerciseReps.value=newExerciseCardio.value=newExerciseNotes.value="";
  saveExerciseBtn.textContent="Salva"; saveExerciseBtn.classList.add("primary"); saveExerciseBtn.classList.remove("edit");
  editIndex=null; modal.classList.remove("hidden");
});

saveExerciseBtn.addEventListener("click",()=>{
  const name=newExerciseName.value.trim(), weight=newExerciseWeight.value.trim(), reps=newExerciseReps.value.trim(), cardio=newExerciseCardio.value.trim(), notes=newExerciseNotes.value.trim();
  if(!name)return alert("Inserisci un nome.");
  const data=loadData(); const day=daySelect.value; if(!data[day]) data[day]=[];
  if(editIndex!==null){
    const ex=data[day][editIndex]; ex.name=name;
    if(weight){ if(!ex.weightHistory) ex.weightHistory=[]; const last=ex.weightHistory[ex.weightHistory.length-1]; if(last!==weight) ex.weightHistory.push(weight);}
    ex.reps=reps||null; ex.cardio=cardio||null; ex.notes=notes||null;
    showToast("Esercizio aggiornato!");
  }else{
    data[day].push({name, weightHistory: weight?[weight]:[], reps: reps||null, cardio: cardio||null, notes: notes||null});
    showToast("Esercizio aggiunto!");
  }
  saveData(data); modal.classList.add("hidden"); renderExercises();
});

function editExercise(day,index){
  const data=loadData(); const ex=data[day][index];
  newExerciseName.value=ex.name;
  newExerciseWeight.value=ex.weightHistory?.[ex.weightHistory.length-1]||"";
  newExerciseReps.value=ex.reps||""; newExerciseCardio.value=ex.cardio||""; newExerciseNotes.value=ex.notes||"";
  modalTitle.textContent="Modifica esercizio"; saveExerciseBtn.textContent="Aggiorna";
  saveExerciseBtn.classList.remove("primary"); saveExerciseBtn.classList.add("edit");
  editIndex=index; modal.classList.remove("hidden");
}

closeModalBtn.addEventListener("click",()=>modal.classList.add("hidden"));

addSectionBtn.addEventListener("click",()=>{
  const name=prompt("Nome sezione:"); if(!name||name.trim()==="")return;
  const data=loadData(); const day=daySelect.value; if(!data[day])data[day]=[];
  data[day].push({isSection:true, sectionName:name.trim()}); saveData(data); renderExercises(); showToast("Sezione aggiunta!");
});

function editSection(day,index){ const data=loadData(); const ex=data[day][index]; const newName=prompt("Rinomina sezione:",ex.sectionName); if(newName&&newName.trim()!==""){ ex.sectionName=newName.trim(); saveData(data); renderExercises(); showToast("Sezione aggiornata!"); } }
function deleteExercise(day,index){ if(!confirm("Vuoi eliminare questo elemento?"))return; const data=loadData(); data[day].splice(index,1); saveData(data); renderExercises(); showToast("Elemento eliminato!"); }
function moveUp(day,index){ if(index===0)return; const data=loadData(); [data[day][index-1],data[day][index]]=[data[day][index],data[day][index-1]]; saveData(data); renderExercises(); }
function moveDown(day,index){ const data=loadData(); if(index===data[day].length-1)return; [data[day][index+1],data[day][index]]=[data[day][index],data[day][index+1]]; saveData(data); renderExercises(); }

daySelect.addEventListener("change",renderExercises);
renderExercises();
</script>
</body>
</html>
